#define DIGITAL_PIN 8
#define PORT PORTB
#define PORT_PIN PORTB0

byte lighting1 [150][3] = {
 {10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0}
};
byte lighting2 [150][3] = {
 {0,0,0},
 {10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0}
};
byte lighting3 [150][3] = {
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{10,0,0},
 {0,0,0},
 {0,0,0},
{0,10,0}
};

void send0(void) {
  asm volatile(
    "sbi  %0, %1\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "cbi   %0, %1\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    ::
    "I" (_SFR_IO_ADDR(PORT)),
    "I" (PORT_PIN)
  );
}

void send1(void) {
  asm volatile(
    "sbi  %0, %1\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "nop\n\t"
    "cbi   %0, %1\n\t"
    "rjmp .+0\n\t"
    "rjmp .+0\n\t"
    "nop\n\t"
    ::
    "I" (_SFR_IO_ADDR(PORT)),
    "I" (PORT_PIN)
  );
}

void sendByte(byte value) {
  cli();
  for(int i = 7; i > -1; i--) {
    if(bitRead(value, i)) {
      send1();
    } else send0();
  }
  sei();
}

void sendRGB(byte r, byte g, byte b) {
  sendByte(g);
  sendByte(r);
  sendByte(b);
}

void sendFrame(byte values[][3]) {

  for(int i = 0; i < 150; i++) {
    sendRGB(values[i][0], values[i][1], values[i][2]);
  }
  
  delay(1);
}

void setup() {
  pinMode(DIGITAL_PIN, OUTPUT);
  digitalWrite(DIGITAL_PIN, 0);
}

void loop() {
  sendFrame(lighting1);
  delay(50);
  sendFrame(lighting2);
  delay(50);
  sendFrame(lighting3);
  delay(50);
}
